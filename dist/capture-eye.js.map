{"version":3,"file":"capture-eye.js","sourceRoot":"","sources":["../src/capture-eye.ts"],"names":[],"mappings":"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","sourcesContent":["import { LitElement, html } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { Constant } from './constant.js';\nimport { getCaptureEyeStyles } from './capture-eye-styles.js';\nimport { ModalManager } from './modal/modal-manager.js';\nimport { CaptureEyeModal } from './modal/capture-eye-modal.js';\n\n@customElement('capture-eye')\nexport class CaptureEye extends LitElement {\n  static override styles = getCaptureEyeStyles();\n\n  /**\n   * If yes, start fetching asset data when the Capture Eye is loaded.\n   * Otherwise the data will only be fetched when the panel is opened.\n   */\n  @property({ type: Boolean })\n  prefetch = false;\n\n  /**\n   * Nid of the asset.\n   */\n  @property({ type: String })\n  nid = '';\n\n  /**\n   * layout name of the asset. Options: original, curated\n   */\n  @property({ type: String })\n  layout = Constant.layout.original;\n\n  get assetUrl() {\n    return `${Constant.url.ipfsGateway}/${this.nid}`;\n  }\n\n  get assetProfileUrl() {\n    return `${Constant.url.profile}${this.nid}`;\n  }\n\n  constructor() {\n    super();\n    /*\n     * Inject link stylesheet to DOM directly since it will not work in shadow DOM\n     */\n    const font = document.createElement('link');\n    font.href = 'https://static-cdn.numbersprotocol.io/fonts/degular.css';\n    font.rel = 'stylesheet';\n    document.head.appendChild(font);\n  }\n\n  buttonTemplate() {\n    return html`\n      <div class=\"capture-eye-button\" @click=${this.showModal}>\n        <img src=${Constant.url.captureEyeIcon} alt=\"Capture Eye\" />\n      </div>\n    `;\n  }\n\n  override render() {\n    return html`\n      <div class=\"capture-eye-container\">\n        <slot\n          @mouseenter=${this.handleMouseEnter}\n          @mouseleave=${this.handleMouseLeave}\n        ></slot>\n        ${this.buttonTemplate()}\n      </div>\n    `;\n  }\n\n  override async connectedCallback() {\n    super.connectedCallback();\n    ModalManager.getInstance().initializeModal();\n    if (this.prefetch) {\n      customElements.whenDefined('capture-eye-modal').then(() => {\n        ModalManager.getInstance().updateModal(\n          this.nid,\n          this.layout,\n          this.getButtonElement(),\n          false\n        );\n      });\n    }\n  }\n\n  private async showModal() {\n    const modalManager = ModalManager.getInstance();\n    const buttonElement = this.getButtonElement();\n    modalManager.updateModal(this.nid, this.layout, buttonElement);\n    this.setButtonActive(true);\n    console.debug(CaptureEyeModal.name); // The line ensures CaptureEyeModal is included in compilation.\n  }\n\n  private getButtonElement(): HTMLElement {\n    return this.shadowRoot?.querySelector('.capture-eye-button') as HTMLElement;\n  }\n\n  private handleMouseEnter() {\n    this.setButtonActive(true);\n  }\n\n  private handleMouseLeave() {\n    const modalManager = ModalManager.getInstance();\n    if (!modalManager.isHidden && modalManager.nid === this.nid) {\n      return; // Do not hide the button if the modal is shown\n    }\n    this.setButtonActive(false);\n  }\n\n  private setButtonActive(active: boolean) {\n    const button = this.getButtonElement();\n    if (button) {\n      if (active) {\n        button.classList.add('active');\n      } else {\n        button.classList.remove('active');\n      }\n    }\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'capture-eye': CaptureEye;\n  }\n}\n"]}